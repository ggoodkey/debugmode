"use strict";var APP=APP||{};!function(){function changeDebugMode(){!0===DEBUG_MODE?(APP.debug("Debug Mode turned off"),APP.setDebugMode(!1)):(APP.setDebugMode(!0),APP.debug("Debug Mode turned on"))}function moveDebugWindow(){layout(),DEBUG_DIV.className=/debugRight/.test(DEBUG_DIV.className)?"":"debugRight"}function timeStamp(d){var m=d.getMinutes(),s=d.getSeconds(),x=d.getMilliseconds();return DEBUG_COUNT++,DEBUG_TIME=d.getTime(),(m=m<10?"0"+m:m)+":"+(s=s<10?"0"+s:s)+":"+(x=(x=x<10?"0"+x:x)<100?"0"+x:x)}function _debug(code,description,severity,timestamp){function span(clas,contents,title){var str='<span class="debug-';return str+=clas,str+='"',title&&(str+=' title="',str+=title,str+='"'),str+=">",str+=contents,str+="</span>"}function print_Val(val){var str="";return val instanceof Function?str=span("function","function() {...}"):"number"==typeof val?str=val>15e11&&val<2e12?span("number",val,new Date(val)):span("number",val):null===val?str=span("error","null"):void 0===val?str=span("error","undefined"):"string"==typeof val?(""===val?str=span("error",'Empty string: ("")'):" "===val?str=span("error",'A space: (" ")'):(val=(val=val.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/\r\n|\r|\n/g,span("text","NL")+"<br />"),str=span("string",val)),str.length>5007&&(str=str.slice(0,5e3)+"</span>"+span("text","...etc. etc. "+str.length/5e3+" times"))):str="boolean"==typeof val?span("boolean",val):"object"==typeof val?val instanceof Date?span("date",val):val instanceof Array?print_Array(val):span("text","{ "+print_Obj(val)+" }"):span("error","???: "+val),val=null,str}function print_Array(arr){var values=[],len=arr.length;if(0===len)return span("array","[ "+span("error","Empty array")+" ]");for(var i=0;i<len;i++)values[i]=print_Val(arr[i]);var str=span("array","[ "+values.join(", ")+" ]");return values=null,arr=null,str}function to_Readable_JSON(str){function enter(){for(out+="<br />",a=0;a<tabDepth;a++)out+="&nbsp;&nbsp;&nbsp;&nbsp;"}function getArrayDepth(position){position++;for(let depth=1,len=str.length;position<len;position++)if("["===str[position]&&(depth++,depth>arrayDepth&&(arrayDepth=depth)),"]"===str[position]&&(depth--,0===depth))return arrayDepth>0&&(arrayEnd=position,tabDepth++,enter()),arrayDepth;return 0}var quote=!1,tabDepth=0,prevChar,out="",a=0,array=0,arrayDepth=0,arrayEnd=0;for(let c=0,len=str.length;c<len;c++)"}"!==str[c]&&("]"!==str[c]||c!==arrayEnd)||quote||(tabDepth--,enter()),out+=str[c],'"'===str[c]&&"\\"!==prevChar?quote=!quote:quote||(","===str[c]?(enter()," "===str[c+1]&&c++):"["===str[c]?(c>arrayEnd&&getArrayDepth(c),array++):"]"===str[c]?0===--array&&(arrayDepth=0):"{"===str[c]&&(tabDepth++,enter()," "===str[c+1]&&c++)),prevChar=str[c];return out}function print_Obj(obj){var pairs=[],a=0,val;for(let key in obj)if(val=obj[key],pairs[a]=key+": "+print_Val(val),++a>25){pairs[a]="continued....";break}return a=null,obj=null,val=null,pairs.join(",")}function toDebugDiv(){/debugmodeOn/.test(HTML_TAG.className)||(HTML_TAG.className=HTML_TAG.className+" debugmodeOn");var debugmessage="<span class='debug-timestamp'>";debugmessage+=timestamp,debugmessage+="    </span><br />&nbsp;&nbsp;",description?void 0!==severity||/error/i.test(description)?debugmessage+=span("error",description+" "+code):debugmessage+=description+" "+code:debugmessage+=code,debugmessage+="<br />",debugmessage+=DEBUG_MESSAGE_DIV.innerHTML,DEBUG_MESSAGE_DIV.innerHTML=debugmessage,debugmessage=null}function toConsole(){var consolemessage=timestamp;description&&(consolemessage+="   "+description+":\n         "),consolemessage+="   ",consolemessage+=code,console.log(consolemessage.replace(/<\/?span[^>]*>/g,"").replace(/<br \/>/g,"\n            ").replace(/&nbsp;/g," ")),consolemessage=null}!0!==DEBUG_TO_CONSOLE||void 0===severity&&!/error/i.test(description)||APP.setDebugMode(!0),(!0===DEBUG_MODE||!0===DEBUG_TO_CONSOLE&&console&&console.log)&&(code=code instanceof Array?to_Readable_JSON(print_Array(code)):code instanceof Function?span("function","function() {...}"):code instanceof Date?span("date",code):null==code?print_Val(code):"object"==typeof code?span("object","{ "+to_Readable_JSON(print_Obj(code))+" }"):print_Val(code)),!0===DEBUG_MODE&&toDebugDiv(),!0===DEBUG_TO_CONSOLE&&console&&console.log&&toConsole(),code=null,description=null}function trim(str){for(str=String(str);/\s\s/g.test(str);)str=str.replace(/\s\s/g," ");return" "===str?"":str.replace(/^\s+|\s+$/gm,"")}function layout(){var width,type="debugShowLarge ";(null!==window.innerWidth?window.innerWidth:null!==document.body&&null!==document.body.clientWidth?document.body.clientWidth:null!==window.screen?window.screen.availWidth:0)<=640&&(type="debugShowSmall "),HTML_TAG.className=trim(type+HTML_TAG.className.replace(/debugShowLarge|debugShowSmall/g,""))}function init(){var stylesheet=document.createElement("style"),span=document.createElement("span");span["aria-hidden"]=!0,span.appendChild(document.createTextNode("тип")),(HIDE_DEBUG_BUTTON=document.createElement("button")).id="hideDebug",HIDE_DEBUG_BUTTON.type="button",HIDE_DEBUG_BUTTON.class="close",HIDE_DEBUG_BUTTON["aria-label"]="Close debug window",HIDE_DEBUG_BUTTON.appendChild(span),(DEBUG_MESSAGE_DIV=document.createElement("div")).id="debugMsg",(DEBUG_DIV=document.createElement("div")).id="debug",DEBUG_DIV.appendChild(HIDE_DEBUG_BUTTON),DEBUG_DIV.appendChild(DEBUG_MESSAGE_DIV),layout(),stylesheet.type="text/css",stylesheet.innerText="#debug{display:none} #hideDebug{padding:6px 10px;color:red;position:fixed} html.debugShowLarge #hideDebug{left:25%;right:auto;right:initial} html.debugShowLarge #debug.debugRight #hideDebug{left:auto;left:initial;right:22px} html.debugShowSmall #hideDebug {left:auto;left:initial;right:12px} html.debugmodeOn #debug{color:#eee;background-color:#111;background-color:rgba(0,0,0,0.7);text-shadow:0 0 2px #000;font-family:Consolas,Courier New,Courier,monospace;position:fixed;top:0;left:0;right:auto;right:initial;width:30%;max-width:400px;height:100%;-ms-word-wrap:break-word;word-wrap:break-word;overflow:auto;visibility:visible;display:block;z-index:1099} html.debugmodeOn #debug.debugRight{left:auto;left:initial;right:0} html.debugShowSmall #debug{position:fixed;width:100%;max-width:100%;height:45%;top:auto;top:initial;bottom:0} html.debugShowSmall #debug.debugRight{top:0;bottom:auto;bottom:initial} .debug-object{color:cyan} .debug-function{color:magenta} .debug-error{color:red} .debug-string{color:lightblue} .debug-boolean{color:lightgreen} .debug-date{color:pink} .debug-number{color:yellow} .debug-text{color:white} .debug-array{color:orange} .debug-timestamp{color:#CCC;font-size:0.75em}",document.head.appendChild(stylesheet),window.document.body.insertBefore(DEBUG_DIV,window.document.body.firstChild),HIDE_DEBUG_BUTTON.addEventListener("click",changeDebugMode),DEBUG_DIV.addEventListener("click",moveDebugWindow),INITIATED=!0}function destroy(){HIDE_DEBUG_BUTTON&&HIDE_DEBUG_BUTTON.removeEventListener("click",changeDebugMode),DEBUG_DIV&&(DEBUG_DIV.removeEventListener("click",moveDebugWindow),window.document.body.removeChild(DEBUG_DIV)),HTML_TAG&&(HTML_TAG.className=trim(HTML_TAG.className.replace(/debugmodeOn|debugShowLarge|debugShowSmall/g,"")))}var DEBUG_COUNT=0,DEBUG_TIME=(new Date).getTime(),DEBUG_STOP=!1,DEBUG_MODE=!1,DEBUG_TO_CONSOLE=!1,ERROR_CACHE=[],CACHE_MSG_INDEX=0,INITIATED=!1,HIDE_DEBUG_BUTTON,DEBUG_DIV,DEBUG_MESSAGE_DIV,HTML_TAG=document.getElementsByTagName("html")[0];APP.setDebugMode=function(debugMode){if(!0===debugMode){for(INITIATED||init(),DEBUG_MODE=debugMode;CACHE_MSG_INDEX-- >0;)_debug.apply(null,ERROR_CACHE[CACHE_MSG_INDEX]);ERROR_CACHE=[]}else!1===debugMode?(destroy(),INITIATED=!1,DEBUG_MODE=debugMode):(DEBUG_MODE=!0,APP.debug(debugMode,"Error: Cannot set DebugMode to",!0));return DEBUG_MODE},APP.setDebugToConsole=function(debugMode){if(!0===debugMode){for(DEBUG_TO_CONSOLE=debugMode;CACHE_MSG_INDEX-- >0;)_debug.apply(null,ERROR_CACHE[CACHE_MSG_INDEX]);ERROR_CACHE=[]}else!1===debugMode?DEBUG_TO_CONSOLE=debugMode:(DEBUG_TO_CONSOLE=!0,APP.debug(debugMode,"Error: Cannot set DebugToConsole to",!0));return DEBUG_TO_CONSOLE},APP.cacheMsg=function(code,description,severity){!0===DEBUG_MODE?APP.debug(code,description,severity):(ERROR_CACHE[CACHE_MSG_INDEX]=[code,description,severity,timeStamp(new Date)],CACHE_MSG_INDEX++)},APP.debug=function(code,description,severity){var d=new Date;if(!0===DEBUG_STOP&&d.getTime()-DEBUG_TIME>5e3&&(DEBUG_COUNT=0,DEBUG_STOP=!1),!1===DEBUG_STOP&&DEBUG_COUNT>250&&d.getTime()<DEBUG_TIME+1e3){var debugmessage="<br />--TOO MANY MESSAGES LOGGED--<br /><br />";debugmessage+=DEBUG_MESSAGE_DIV.innerHTML,DEBUG_MESSAGE_DIV.innerHTML=debugmessage,debugmessage=null,DEBUG_STOP=!0}!1===DEBUG_STOP&&_debug(code,description,severity,timeStamp(d)),d=null}}();